<div class="orders-table">
  <p-table [value]="ordersList" dataKey="id" [expandedRowKeys]="expandedRows"
    [globalFilterFields]="['id', 'customer', 'school', 'status']">
    <ng-template pTemplate="header">
      <tr>
        <th style="width: 5rem"></th>
        <th>Order ID</th>
        <th>Customer</th>
        <th>School</th>
        <th>Status</th>
        <th>Price</th>
      </tr>
      <tr>
        <th style="width: 5rem"></th>
        <th>
          <p-columnFilter type="numeric" field="id" placeholder="Search by ID" ariaLabel="Filter ID" />
        </th>
        <th>
          <p-columnFilter type="text" field="customer" placeholder="Search by customer" ariaLabel="Filter Customer" />
        </th>
        <th>
          <p-columnFilter type="text" field="school" placeholder="Search by school" ariaLabel="Filter School" />
        </th>
        <th>
          <p-columnFilter type="text" field="status" placeholder="Search by status" ariaLabel="Filter Status" />
        </th>
        <th>
          <p-columnFilter type="numeric" field="price" placeholder="Search by price" ariaLabel="Filter Price" />
        </th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-order let-expanded="expanded">
      <tr>
        <td>
          <p-button type="button" [pRowToggler]="order" [text]="true" [rounded]="true" [plain]="true"
            [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'" />
        </td>
        <td>{{ order.id }}</td>
        <td>{{ order.customer }}</td>
        <td>{{ order.school }}</td>
        <td>{{ order.status }}</td>
        <td>{{ order.price | currency:"USD" }}</td>
      </tr>
    </ng-template>
    <ng-template pTemplate="rowexpansion" let-order>
      <tr>
        <td colspan="6">
          <div style="margin: 0.75rem">
            <span class="order-details">
              <strong>Order created on:</strong> {{ order.createdOn | date:'longDate'}}
            </span>
            <span class="order-details">
              <strong>Order updated on:</strong> {{ order.updatedOn | date:'longDate'}}
            </span>
            <div style="margin-top: 1rem">
              <strong>Description:</strong> {{ order.description }}
            </div>
          </div>
        </td>
      </tr>
      <tr>
        <td colspan="6">
          <div class="p-0">
            <p-table [value]="order.products" dataKey="id">
              <ng-template pTemplate="header">
                <tr>
                  <th style="width: 5rem"></th>
                  <th>Product ID</th>
                  <th>Name</th>
                  <th># Needed</th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-product>
                <tr>
                  <th style="width: 5rem"></th>
                  <td>{{ product.id }}</td>
                  <td>{{ product.name }}</td>
                  <td>{{ product.quantity }}</td>
                </tr>
              </ng-template>
              <ng-template pTemplate="emptymessage">
                <tr>
                  <td colspan="6">There are no products associated with this order.</td>
                </tr>
              </ng-template>
            </p-table>
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
